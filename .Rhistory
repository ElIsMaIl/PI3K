setwd("E:/CCCC/PI3K")
seurat_integrated <- readRDS("E://CCCC/PI3K/data/SeuratObjects/cellfiltering_umi/Human/seurat_integrated_with_spec_labels.rds")
seurat_integrated_filtered_human <- readRDS("E://CCCC/PI3K/data/SeuratObjects/demultiplexed/Human/seurat_integrated_filtered_human.rds")
library(Matrix)
library(Matrix.utils)
library(tidyverse)
library(Seurat)
library(dplyr)
library(knitr)
library(ggsci)
library(RCurl)
library(cowplot)
library(SingleR)
library(caret)
library(multtest)
library(clustree)
library(limma)
UMAP_human <- DimPlot(seurat_integrated, reduction = "umap", group.by= "Labels", cols = c("red","lightgrey","purple")) + ggtitle("UMAP human cells")
UMAP_human
seurat_integrated_filtered_human <- RunUMAP(seurat_integrated_filtered_human, dims = 1:30)
DimPlot(seurat_integrated_filtered_human, reduction = "umap", group.by = "Sample_Tag") + ggtitle("UMAP human cells by conditions")
metadata <- seurat_integrated@meta.data
metadata %>% select(2,26) -> metadata
table(metadata)
